@model IEnumerable<FMDSS.Models.WaterFireModel>
@{
    ViewBag.Title = "WaterResFFLineDetails";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<div class="col-lg-9 pad">
    <h1 class="page-header">Water Resource & Forest Fire Line</h1>
</div>
<div class="row">
    <div class="col-md-9" style="width:80%;">
        <div class="panel with-nav-tabs panel-default">
            <div class="panel-heading">
                <ul class="nav nav-tabs" id="myTab">
                    <li class="active"><a href="#tab2default" data-toggle="tab"><i class="fa fa-tint fa-fw"></i>Water Resource Manager Line</a></li>
                    @*<li class=""><a href="#tab3default " data-toggle="tab"><i class="fa fa-fire fa-fw"></i>Forest Fire Line</a></li>*@
                </ul>
                <div class="panel-body">
                    <div class="tab-content">
                        <div class="tab-pane fade  in tbl-scroll active" id="tab2default" style="min-height:500px!important;">
                            <div class="panel-body">
                                @*<div class="col-lg-8">
                                        <div class="form-group">
                                        </div>
                                    </div>*@
                                @*<div class="col-lg-4">
                                        <div class="form-group">
                                            <input type="text" class="form-control" placeholder="Search" id="searchval" onblur="searchs();">
                                        </div>
                                    </div>*@
                                <div class="col-lg-12">
                                    <div class="table-responsive">
                                        <table class="table table-striped table-bordered table-hover table-responsive" id="dataTables-example">
                                            <thead>
                                                <tr>
                                                    <th>Sr. No.</th>
                                                    <th>Division</th>
                                                    <th>Range</th>
                                                    <th>Naka</th>
                                                    <th>Block</th>
                                                    <td>Source Name</td>
                                                    <td>Source Image</td>
                                                    <td>Destination Name</td>
                                                    <td>Destination Image</td>
                                                    <th> Water Point Lat Long</th>
                                                    <th>Water Source Lat Long</th>
                                                    <th>Distance (km)</th>
                                                    <th>Date</th>
                                                    <th>Action</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                @{
                                                    var WRList = ViewBag.WRList as IEnumerable<FMDSS.Models.WaterFireModel>;
                                                    foreach (var item in WRList)
                                                    {
                                                        <tr>
                                                            <td>
                                                                @item.SNO
                                                            </td>
                                                            <td>
                                                                @item.DivisionName
                                                            </td>
                                                            <td>
                                                                @item.RangeName
                                                            </td>
                                                            <td>
                                                                @item.NakaName
                                                            </td>
                                                            <td>
                                                                @item.BlockName
                                                            </td>
                                                            <td>
                                                                @item.SourceName
                                                            </td>
                                                            <td>
                                                                @if (!string.IsNullOrEmpty(item.WaterSourceImagePath))
                                                                {
                                                                    <a href="/@item.WaterSourceImagePath" target="_blank" ><i class="fa fa-eye"></i></a>
                                                                }
                                                                else
                                                                {
                                                                    @Html.DisplayName("N/A")
                                                                }

                                                            </td>
                                                            <td>
                                                                @item.DestinationName
                                                            </td>
                                                            <td>
                                                                @if (!string.IsNullOrEmpty(item.WaterPointImagePath))
                                                                {
                                                                    <a href="/@item.WaterPointImagePath" target="_blank"><i class="fa fa-eye"></i></a>
                                                                }
                                                                else
                                                                {
                                                                    @Html.DisplayName("N/A")
                                                                }

                                                            </td>
                                                            <td>
                                                                @item.WaterPoint_LatLong
                                                            </td>
                                                            <td>
                                                                @item.WaterSource_LatLong
                                                            </td>
                                                            <td>
                                                                @item.Distance
                                                            </td>
                                                            <td>
                                                                @item.EnteredOn
                                                            </td>
                                                            <td>
                                                                @*<button type="button" class="btn btn-info" title="View more details" onclick="return ShowDetails('@item.WaterPoint_LatLong', this)">
                                                                        <i class="fa fa-eye">View Details</i>
                                                                    </button>*@
                                                                <button type="button" class="btn btn-success btn-circle" onclick="return GetWaterRefillDetail('@item.SourceLatLong','@item.DestinationLatLong', this)" title="View Refill Details" data-toggle="modal" data-target="#OffenseCategoryPopup">
                                                                    <i class="fa fa-eye"></i>
                                                                </button>
                                                            </td>
                                                        </tr>
                                                    }
                                                }
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>

                        </div>
                        <div class="tab-pane fade in tbl-scroll" id="tab3default" style="min-height:500px!important;">

                            <div class="panel-body">
                                @*<div class="col-lg-8">
                                        <div class="form-group">
                                        </div>
                                    </div>
                                    <div class="col-lg-4">
                                        <div class="form-group">
                                            <input type="text" class="form-control" placeholder="Search" id="searchval1" onblur="searchs1();">
                                        </div>
                                    </div>*@
                                <div class="col-lg-12">
                                    <div class="table-responsive">
                                        <table class="table table-striped table-bordered table-hover table-responsive" id="dataTables-example1">
                                            <thead>
                                                <tr>
                                                    <th>Sr. No.</th>
                                                    <th>Division</th>
                                                    <th>Range</th>
                                                    <th>Naka</th>
                                                    <th>Block</th>
                                                    <th>Fire Line Start Latitude</th>
                                                    <th>Fire Line Start Longitude</th>
                                                    <th>Fire Line End Latitude</th>
                                                    <th>Fire Line End Longitude</th>
                                                    <th>Watch Tower Latitude</th>
                                                    <th>Watch Tower Longitude</th>
                                                    <th>Entered On</th>
                                                    <th>Entered By</th>
                                                    <th>View</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                @{
                                                    var FFlist = ViewBag.FFLineList as IEnumerable<FMDSS.Models.WaterFireModel>;
                                                    foreach (var item in FFlist)
                                                    {
                                                        <tr>
                                                            <td>
                                                                @item.SNO
                                                            </td>
                                                            <td>
                                                                @item.DivisionName
                                                            </td>
                                                            <td>
                                                                @item.RangeName
                                                            </td>
                                                            <td>
                                                                @item.NakaName
                                                            </td>
                                                            <td>
                                                                @item.BlockName
                                                            </td>
                                                            <td>
                                                                @item.StartLatitude
                                                            </td>
                                                            <td>
                                                                @item.StartLongitude
                                                            </td>
                                                            <td>
                                                                @item.EndLatitude
                                                            </td>
                                                            <td>
                                                                @item.EndLongitude
                                                            </td>
                                                            <td>
                                                                @item.Source_StartLatitude
                                                            </td>
                                                            <td>
                                                                @item.Source_StartLongitude
                                                            </td>
                                                            <td>
                                                                @item.EnteredOn
                                                            </td>
                                                            <td>
                                                                @item.Enteredby
                                                            </td>
                                                            <td>
                                                                @{ var FirstImage = "";
                                                                 if (item.WaterPointImagePath != null && string.IsNullOrEmpty(item.WaterPointImagePath) == false)
                                                                 {
                                                                     FirstImage = UrlHelper.GenerateContentUrl(item.WaterPointImagePath, this.ViewContext.HttpContext);
                                                                    <button type="button" class="btn btn-warning btn-circle EditDepot" title="Fire Line Image">
                                                                        <a href="@Url.Content("/fmdsstest/"+item.WaterPointImagePath)" title="Fire Line Image" target="_blank">
                                                                            <i class="fa fa-eye"></i>
                                                                        </a>
                                                                    </button> }
                                                                }
                                                                @{ var SecondImage = "";
                                                                 if (item.WaterSourceImagePath != null && string.IsNullOrEmpty(item.WaterSourceImagePath) == false)
                                                                 {
                                                                     SecondImage = UrlHelper.GenerateContentUrl(item.WaterSourceImagePath, this.ViewContext.HttpContext);
                                                                    <button type="button" class="btn btn-warning btn-circle EditDepot" title="Watch Tower Image">
                                                                        <a href="@Url.Content("/fmdsstest/"+item.WaterSourceImagePath)" title="Watch Tower Image" target="_blank">
                                                                            <i class="fa fa-eye"></i>
                                                                        </a>
                                                                    </button>
                                                                 }
                                                                }
                                                            </td>
                                                        </tr>
                                                    }
                                                }
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal fade in" data-backdrop="static" id="modalTPDetails" tabindex="1" role="dialog" aria-hidden="false"></div>



        </div>
    </div>

</div>

<div class="modal fade" id="OffenseCategoryPopup" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="display: none;">
    <div class="modal-dialog mdw" style="width:750px;">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                <h4 class="modal-title" id="myModalLabel">Water Refill Details</h4>
            </div>

            <div class="modal-body" id="refillData">

            </div>

            <!-- /.modal-body -->

            <div class="modal-footer" style="clear:both">
                <button name="button" class="btn btn-danger" type="submit" value="Cancel" data-dismiss="modal" style="width:auto">
                    <i class="fa fa-times fa-fw"></i> Close
                </button>
            </div>
        </div>
        <!-- /.modal-content -->
    </div>
    <!-- /.modal-dialog -->
</div>



<link href="https://cdn.datatables.net/buttons/1.5.2/css/buttons.dataTables.min.css" rel="stylesheet" />
<link href="~/css/bootstrap-multiselect.css" rel="stylesheet" />
<script type="text/javascript" src="https://cdn.datatables.net/1.10.19/js/jquery.dataTables.min.js"></script>
<script type="text/javascript" src="https://cdn.datatables.net/buttons/1.5.2/js/dataTables.buttons.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.36/pdfmake.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.36/vfs_fonts.js"></script>
<script type="text/javascript" src="https://cdn.datatables.net/buttons/1.5.2/js/buttons.html5.min.js"></script>
<script src="~/js/bootstrap-multiselect.js"></script>
<script type="text/javascript">
    var RootUrl = '@Url.Content("~/")';

    function ShowDetails(WaterPoint_LatLong, cntrlID) {
        $.ajax({
            type: 'GET',
            url: RootUrl + 'WaterResource/WRDetials',
            dataType: 'html',
            data: { WaterPoint_LatLong },
            success: function (data) {
                $('#modalTPDetails').html(data);
                $('#modalTPDetails').show();
            },
            error: function (ex) {
                alert(ex.error);
            }
        });


    }
    function GetWaterRefillDetail(sourceId, destinationId, cntrlID) {

        $.ajax({
            type: 'GET',
            url: RootUrl + 'WaterResource/_GetWaterRefillList',
            dataType: 'html',
            data: { sourceLatLong: sourceId, destinationLatLong: destinationId },
            success: function (data) {
                $('#refillData').html(data);
                //$('#modalTPDetails').show();
            },
            error: function (ex) {
                alert(ex.error);
            }
        });

    }
</script>
<script type="text/javascript">
    var table;
    $(document).ready(function () {
        table = $('#dataTables-example').DataTable({
            "aaSorting": [],
            "iDisplayLength": 25,
            dom: 'Bfrtip',
            buttons: [
                {
                    extend: 'excelHtml5',
                    title: 'Water Resource Manager Line',
                    exportOptions: {
                        columns: ':visible'

                    }
                }
            ]
        });

    });
    $(document).ready(function () {
        table = $('#dataTables-example1').DataTable({
            "aaSorting": [],
            "iDisplayLength": 25,
            dom: 'Bfrtip',
            buttons: [
                {
                    extend: 'excelHtml5',
                    title: 'Forest Fire Line',
                    exportOptions: {
                        columns: ':visible'

                    }
                }
            ]
        });

    });


</script>
<style>
    #modalTPDetails .tbl-scroll {
        overflow-y: auto;
        max-height: 400px !important;
    }

    #modalTPDetails .modal-dialog {
        width: 720px !important;
    }

    #modalTPDetails .scroll {
        overflow-y: auto;
        max-height: 350px !important;
    }
</style>
